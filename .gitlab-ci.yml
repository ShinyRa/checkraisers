stages:
  - install
  - build
  - deploy

install:
  stage: install
  cache: 
    key: ${CI_BUILD_REF_NAME}
    paths:
      - node_modules/
  script:
    yarn
  only:
    changes:
      - package-lock.json
    
build:
  stage: build
  cache: 
    key: ${CI_BUILD_REF_NAME}
    paths:
      - node_modules/
    policy: pull
  script:
    - yarn build
  artifacts:
    paths:
      - build
  only:
    - development

deploy:
  stage: deploy
  dependencies: 
    - build
  script:
    - node index.js
  only:
    - development
